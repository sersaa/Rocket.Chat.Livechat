(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{"/9tl":function(e,t,r){"use strict";(function(e,n){r.d(t,"a",function(){return j});var a=r("gDde"),i=r("co3k"),o=r("z4Qk"),l=r("qoM+"),u=r("jdJj"),s=r("PyG4"),c=r("qYlV"),d=r.n(c);function p(){return(p=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function m(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;i.length>n;n++)0>t.indexOf(r=i[n])&&(a[r]=e[r]);return a}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function h(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(r,!0).forEach(function(t){b(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=e.t("Need help?"),y=e.t("Please, tell us some information to start the chat"),O=function(e){return void 0===e&&(e=[]),1===e.length&&e[0]._id||""},w=n(u.b.Footer,null),j=function(t){var r,a;function c(e){var r;return b(v(r=t.call(this,e)||this),"state",{name:null,email:null,department:null}),b(v(r),"validations",{name:[l.e.nonEmpty],email:[l.e.nonEmpty,l.e.email],department:[]}),b(v(r),"getDefaultState",function(){var e=r.props,t=e.customFields,n=void 0===t?[]:t,a=h({},e.hasNameField&&{name:{value:""}},{},e.hasEmailField&&{email:{value:""}},{},e.hasDepartmentField&&{department:{value:O(e.departments)}});return n.forEach(function(e){var t=e._id,r=e.defaultValue,n=e.options,i=e.regexp,o="";(r&&!n||Array.isArray(n)&&n.includes(r))&&(o=r),a[t]=h({value:o},i&&{regexp:i})}),a}),b(v(r),"getCustomValidations",function(){var e=r.props.customFields;return(void 0===e?[]:e).map(function(e){var t,r=e._id,n=e.regexp,a=[];return e.required&&a.push(l.e.nonEmpty),n&&a.push(l.e.custom),(t={})[r]=a,t}).reduce(function(e,t){return h({},e,{},t)},{})}),b(v(r),"getValidableFields",function(){return Object.keys(r.validations).map(function(e){return r.state[e]?h({fieldName:e},r.state[e]):null}).filter(Boolean)}),b(v(r),"validate",function(e){var t=e.value,n=e.regexp;return r.validations[e.name].reduce(function(e,r){return e||r({value:t,pattern:n})},void 0)}),b(v(r),"validateAll",function(){var e=r.getValidableFields(),t=Array.isArray(e),n=0;for(e=t?e:e[Symbol.iterator]();;){var a,i;if(t){if(n>=e.length)break;i=e[n++]}else{if((n=e.next()).done)break;i=n.value}var o=i.fieldName,l=i.value,u=r.validate({name:o,value:l,regexp:i.regexp});r.setState(((a={})[o]=h({},r.state[o],{value:l,error:u,showError:!1}),a))}}),b(v(r),"isValid",function(){return r.getValidableFields().every(function(e){return!(void 0===e?{}:e).error})}),b(v(r),"handleFieldChange",function(e){var t,n=e.target,a=n.name,i=n.value,o=r.validate({name:a,value:i,regexp:r.state[a].regexp});r.setState(((t={})[a]=h({},r.state[a],{value:i,error:o,showError:!0}),t))}),b(v(r),"handleSubmit",function(e){if(e.preventDefault(),r.props.onSubmit){var t=Object.entries(r.state).filter(function(e){return null!==e[1]}).map(function(e){var t;return(t={})[e[0]]=e[1].value,t}).reduce(function(e,t){return h({},e,{},t)},{});r.props.onSubmit(t)}}),r.setState(r.getDefaultState()),r.validations=h({},r.validations,{},r.getCustomValidations()),r.validateAll(),r}a=t,(r=c).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a;var f=c.prototype;return f.componentWillReceiveProps=function(e){var t=e.hasNameField,r=e.hasEmailField,n=e.hasDepartmentField,a=e.departmentDefault,i=e.departments,o=e.emailDefault,l=e.nameDefault||"";!t||this.state.name&&this.state.name===l?t||this.setState({name:null}):this.setState({name:h({},this.state.name,{value:l})});var u=o||"";!r||this.state.email&&this.state.name===u?r||this.setState({email:null}):this.setState({email:h({},this.state.email,{value:u})});var s=a||O(i),c=n&&i&&i.length>1;!c||this.state.department&&this.state.department===s?c||this.setState({department:null}):this.setState({department:h({},this.state.department,{value:s})}),this.validateAll()},f.render=function(t,r){var a=t.title,c=t.color,f=t.message,h=t.loading,v=t.departments,b=t.customFields,O=m(t,["title","color","message","loading","departments","customFields"]),j=r.name,F=r.email,D=r.department,P=m(r,["name","email","department"]),S=this.isValid();return n(u.b,p({color:c,title:a||g,className:Object(s.d)(d.a,"register")},O),n(u.b.Content,null,n("p",{className:Object(s.d)(d.a,"register__message")},f||y),n(l.a,{onSubmit:this.handleSubmit},j?n(l.b,{required:!0,label:e.t("Name"),error:j.showError&&j.error},n(l.d,{name:"name",value:j.value,placeholder:e.t("Insert your %{field} here...",{field:e.t("Name")}),disabled:h,onInput:this.handleFieldChange})):null,F?n(l.b,{required:!0,label:e.t("Email"),error:F.showError&&F.error},n(l.d,{name:"email",value:F.value,placeholder:e.t("Insert your %{field} here...",{field:e.t("Email")}),disabled:h,onInput:this.handleFieldChange})):null,D?n(l.b,{label:e.t("I need help with..."),error:D.showError&&D.error},n(l.c,{name:"department",value:D.value,options:Object(s.m)(v,"name").map(function(e){return{value:e._id,label:e.name}}),placeholder:e.t("Choose an option..."),disabled:h,onInput:this.handleFieldChange})):null,b&&function(t,r,a){var i=r.loading,o=r.handleFieldChange,u=void 0===o?function(){}:o;return t.map(function(t){var r=t._id,o=t.required,s=t.label,c=t.options;switch(t.type){case"input":return n(l.b,{label:s,required:o,key:r,error:a[r].showError&&a[r].error},n(l.d,{name:r,placeholder:e.t("Insert your %{field} here...",{field:s}),value:a[r].value,disabled:i,onInput:u,custom:!0}));case"select":return n(l.b,{label:s,required:o,key:r,error:a[r].showError&&a[r].error},n(l.c,{name:r,value:a[r].value,placeholder:e.t("Choose an option..."),options:c&&c.map(function(e){return{value:e,label:e}}),disabled:i,onInput:u,custom:!0}))}return null})}(b,{loading:h,handleFieldChange:this.handleFieldChange},P),n(o.a,null,n(i.a,{submit:!0,loading:h,disabled:!S||h,stack:!0},e.t("Start chat"))))),w)},c}(a.Component)}).call(this,r("fsQa").default,r("gDde").h)},B2hK:function(e,t,r){"use strict";r.r(t);var n=r("/9tl");r.d(t,"Register",function(){return n.a});var a=r("gjNO");r.d(t,"RegisterContainer",function(){return a.b}),r.d(t,"RegisterConnector",function(){return a.a}),r.d(t,"default",function(){return a.c})},gjNO:function(e,t,r){"use strict";(function(e){r.d(t,"b",function(){return h}),r.d(t,"a",function(){return v});var n=r("gDde"),a=r("Y3FI"),i=r("qPgm"),o=r("vBLd"),l=r("SvlM"),u=r("kQFM"),s=r("/9tl");function c(){return(c=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;i.length>n;n++)0>t.indexOf(r=i[n])&&(a[r]=e[r]);return a}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h=function(t){var r,n;function u(){for(var r,n=arguments.length,a=new Array(n),l=0;n>l;l++)a[l]=arguments[l];return f(m(r=t.call.apply(t,[this].concat(a))||this),"getDepartment",function(e){if(""!==e)return e;var t=r.props.departments,n=(void 0===t?{}:t).find(function(e){return e.showOnRegistration});return n?n._id:void 0}),f(m(r),"handleSubmit",function(e){return new Promise(function(t,n){var a,l,u,s,c,m,h,v,b=function(e){return function(t){try{return Promise.resolve(m({loading:!1})).then(function(){try{return e&&e.call(this,t)}catch(e){return n(e)}}.bind(this),n)}catch(e){return n(e)}}.bind(this)}.bind(this);return a=e.name,l=e.email,u=e.department,s=p(e,["name","email","department"]),m=(c=r.props).dispatch,h=c.token,v={name:a,email:l,department:r.getDepartment(u)},Promise.resolve(m({loading:!0,department:u})).then(function(){try{var e=function(){try{return t()}catch(e){return n(e)}},a=function(e){try{throw e}catch(e){return b(n)(e)}};try{return Promise.resolve(i.a.grantVisitor({visitor:function(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(r,!0).forEach(function(t){f(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},v,{token:h})})).then(function(t){try{return Promise.resolve(m({user:t})).then(function(){try{return Object(o.a)("callback",["pre-chat-form-submit",v]),r.registerCustomFields(s),b(e)()}catch(e){return a(e)}},a)}catch(e){return a(e)}},a)}catch(e){a(e)}}catch(e){return n(e)}},n)})}),f(m(r),"render",function(t){return e(s.a,c({},t,{onSubmit:r.handleSubmit,departmentDefault:r.getDepartmentDefault()}))}),r}n=t,(r=u).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n;var h=u.prototype;return h.registerCustomFields=function(e){void 0===e&&(e={}),Object.entries(e).forEach(function(e){var t=e[1];t&&""!==t&&l.a.setCustomField(e[0],t,!0)})},h.getDepartmentDefault=function(){var e=this.props,t=e.guestDepartment,r=e.departments;if(r&&r.some(function(e){return e._id===t}))return t},h.componentDidUpdate=function(e){var t=this.props.user;!e.user&&t&&t._id&&Object(a.b)("/")},u}(n.Component),v=function(t){var r=t.ref,n=p(t,["ref"]);return e(u.a,null,function(t){var a=t.config,i=(a=void 0===a?{}:a).departments,o=void 0===i?{}:i,l=a.messages;l=void 0===l?{}:l;var u=a.settings;u=void 0===u?{}:u;var s=a.theme;s=void 0===s?{}:s;var d=a.customFields,p=void 0===d?[]:d,m=t.iframe,f=(m=void 0===m?{}:m).guest,v=(f=void 0===f?{}:f).department,b=f.name,g=f.email,y=m.theme,O=(y=void 0===y?{}:y).title,w=t.loading,j=void 0!==w&&w,F=t.token,D=t.dispatch,P=t.user;return e(h,c({ref:r},n,{theme:{color:y.color||s.color,fontColor:y.fontColor,iconColor:y.iconColor,title:O},title:O||s.title,message:l.registrationFormMessage,hasNameField:u.nameFieldRegistrationForm,hasEmailField:u.emailFieldRegistrationForm,hasDepartmentField:o&&o.some(function(e){return e.showOnRegistration}),departments:o.filter(function(e){return e.showOnRegistration}),nameDefault:b,emailDefault:g,guestDepartment:v,loading:j,token:F,dispatch:D,user:P,customFields:p}))})};t.c=v}).call(this,r("gDde").h)}}]);